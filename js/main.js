var debugAudio = {"status":1,"err_code":0,"data":{"hash":"E07BD0E7B85AA2EF756A434992E297AB","timelength":171055,"filesize":2745379,"audio_name":"\u4e09\u65e0Marblue - \u4f60\u597d","have_album":0,"album_name":"\u672a\u77e5\u4e13\u8f91","album_id":0,"img":"http:\/\/singerimg.kugou.com\/uploadpic\/softhead\/400\/20150812\/20150812184553985185.jpg","have_mv":0,"video_id":0,"author_name":"\u4e09\u65e0Marblue","song_name":"\u4f60\u597d","lyrics":"[00:00.41]\u4f60\u597d - \u4e09\u65e0\r\n[00:00.59]\u8bcd\uff1a\u5927\u94ed\r\n[00:00.73]\u66f2\uff1aMusikM\r\n[00:00.84]\u7f16\u66f2\uff1aJun Kuroda\r\n[00:01.02]\u5236\u4f5c\u4eba\uff1aMusikM\/musiXboy\r\n[00:01.21]\u4e2d\u6587\u8c03\u6559\uff1aDigger\r\n[00:01.42]\u6df7\u97f3\uff1aJun Kuroda\r\n[00:01.61]\u6bcd\u5e26\uff1aJun Kuroda\r\n[00:01.79]\u97f3\u7b26\u8fd8\u6ca1\u8fde\u63a5\u4e32\u597d\r\n[00:03.48]\u6b4c\u8bcd\u7075\u611f\u8fd8\u5728\u5bfb\u627e\r\n[00:05.22]\u4e2d\u56fd\u8001\u5e08\u6559\u5b66\u5f00\u59cb\r\n[00:06.92]\u4e2d\u6587\u95ee\u5019\u8981\u8bf4\u4f60\u597d\r\n[00:08.65]\u521d\u6b21\u89c1\u9762\u8bf7\u591a\u5173\u7167\r\n[00:10.30]\u306f\u3058\u3081\u3066\u3088\u308d\u3057\u304f\r\n[00:12.04]\u6211\u662f\u521d\u6765\u4e4d\u5230 \u8bf7\u591a\u5173\u7167\r\n[00:15.51]\u522b\u626d\u7684\u53d1\u97f3\u548c\u8bed\u6cd5\r\n[00:17.18]\u6211\u60f3\u6211\u5f97\u7ec3\u4e60\u5bf9\u8bdd\r\n[00:18.87]\u7a7f\u68ad\u5728\u65e7\u5e02\u573a \u5b66\u4e60\u780d\u4ef7\r\n[00:22.35]\u73b0\u5728\u51e0\u70b9\u8981\u901a\u8bdd\u5417\r\n[00:24.01]\u96f6\u6563\u6563\u7684\u8bcd\u53e5\u8868\u8fbe\r\n[00:25.86]\u6211\u62ff\u51fa\u62fc\u97f3\u8868 \u5c0f\u58f0\u56de\u7b54\r\n[00:43.22]\u4f60\u597d\r\n[00:44.73]Hello\r\n[00:46.41]\u3053\u3093\u306b\u3061\u306f\r\n[00:48.11]\u65e9\u4e0a\u597d\r\n[00:49.74]\u5fae\u7b11\r\n[00:51.51]Smile\r\n[00:53.10]\u308f\u3089\u304a\u3046\r\n[00:54.71]\u7ed9\u4e2a\u62e5\u62b1\r\n[00:56.72]\u4f60\u597d\r\n[00:58.38]Hello\r\n[01:00.06]\u3053\u3093\u306b\u3061\u306f\r\n[01:01.83]\u65e9\u4e0a\u597d\r\n[01:03.56]\u5fae\u7b11\r\n[01:05.24]Smile\r\n[01:06.92]\u308f\u3089\u304a\u3046\r\n[01:08.40]\u5929\u6c14\u771f\u597d\r\n[01:24.34]\u73b0\u5728\u51e0\u70b9\u8981\u89c1\u9762\u5417\r\n[01:25.74]\u7b49\u6211\u5e26\u4e0a\u8bcd\u5178\u51fa\u53d1\r\n[01:27.46]\u5947\u602a\u7684\u8857\u9053\u540d \u770b\u5f97\u773c\u82b1\r\n[01:31.02]\u4e2d\u6587\u95ee\u5019\u8981\u8bf4\u4f60\u597d\r\n[01:32.66]\u521d\u6b21\u89c1\u9762\u8bf7\u591a\u5173\u7167\r\n[01:34.45]\u6253\u4e2a\u62db\u547c\u8981\u95ee \u5403\u6ca1\u5403\u9971\r\n[01:37.78]\u73b0\u5728\u51e0\u70b9\u5403\u996d\u4e86\u5417\r\n[01:39.45]\u706b\u9505\u4e00\u5b9a\u8981\u9009\u9ebb\u8fa3\r\n[01:41.18]\u684c\u4e0a\u7684\u957f\u83dc\u5355 \u770b\u5f97\u773c\u82b1\r\n[01:44.81]\u73b0\u5728\u51e0\u70b9\u8981\u901b\u8857\u5417\r\n[01:46.48]\u4f60\u53cd\u590d\u7528\u53cc\u8bed\u4ecb\u7ecd\r\n[01:48.10]\u4e00\u76f4\u5230\u70ed\u5e26\u9c7c \u5168\u90fd\u7761\u7740\r\n[01:51.51]\u624b\u628a\u624b\u6559\u6211\u7684\u4e66\u6cd5\r\n[01:53.22]\u63e1\u8d77\u6bdb\u7b14\u4e00\u6487\u4e00\u637a\r\n[01:54.92]\u6240\u6709\u504f\u65c1\u90e8\u9996\u76f8\u52a0\r\n[01:56.61]\u662f\u4f60\u6559\u6211\u7684\u90a3\u53e5\u8bdd\r\n[01:58.33]\u5927\u58f0\u8bf4\u51fa\u559c\u6b22\u4f60\u5440\r\n[02:00.02]\u5927\u58f0\u56de\u7b54\u559c\u6b22\u6211\u5417\r\n[02:01.71]\u8fd9\u662f\u6700\u7b80\u5355\u7684\u8bed\u6cd5\r\n[02:03.41]\u8ba9\u4eba\u5fc3\u52a8\u7684\u4e2d\u56fd\u8bdd\r\n[02:05.36]\u73b0\u5728\u51e0\u70b9\u8981\u901a\u8bdd\u5417\r\n[02:06.86]\u96f6\u6563\u6563\u7684\u8bcd\u53e5\u8868\u8fbe\r\n[02:08.53]\u73b0\u5728\u51e0\u70b9\u8981\u89c1\u9762\u5417\r\n[02:10.22]\u7b49\u6211\u5e26\u4e0a\u8bcd\u5178\u51fa\u53d1\r\n[02:12.02]\u73b0\u5728\u51e0\u70b9\u8981\u5403\u996d\u5417\r\n[02:13.67]\u706b\u9505\u4e00\u5b9a\u8981\u9009\u9ebb\u8fa3\r\n[02:15.42]\u73b0\u5728\u51e0\u70b9\u8981\u901b\u8857\u5417\r\n[02:17.09]\u4f60\u53cd\u590d\u7528\u53cc\u8bed\u4ecb\u7ecd\r\n[02:19.07]\u559c\u6b22\u4f60\u5440\u559c\u6b22\u6211\u5417\r\n[02:20.69]\u6211\u53ea\u60f3\u8981\u542c\u4f60\u56de\u7b54\r\n[02:22.28]\u559c\u6b22\u4f60\u5440\u559c\u6b22\u6211\u5417\r\n[02:24.01]\u6211\u53ea\u60f3\u8981\u542c\u4f60\u56de\u7b54\r\n[02:25.68]\u559c\u6b22\u4f60\u5440\u559c\u6b22\u6211\u5417\r\n[02:27.38]\u6211\u53ea\u60f3\u8981\u542c\u4f60\u56de\u7b54\r\n[02:29.13]\u559c\u6b22\u4f60\u5440\u559c\u6b22\u6211\u5417\r\n[02:30.84]\u6211\u53ea\u60f3\u8981\u542c\u4f60\u56de\u7b54\r\n","author_id":"183204","privilege":0,"privilege2":"0","play_url":"http:\/\/fs.w.kugou.com\/201801101054\/8cdf3ac139d1408051da50330129a2f6\/G120\/M08\/0F\/05\/GIcBAFozlWyAXnnPACnkI_h3UKE073.mp3","authors":[{"is_publish":"1","author_id":"183204","avatar":"20150812184553985185.jpg","author_name":"\u4e09\u65e0Marblue"}],"bitrate":128}}
//歌词模板缓存
var  into = ["none","block","rgba(0,0,0,0)",">>"];
var eles = [document.getElementById("left"),document.getElementById("right"),document.getElementById("audioOng"),document.getElementById("bottom"),document.getElementById("audioImg")]
//歌词模板显示与隐藏
function audioShow(){
	var k = "";
	k = eles[0].style.display;
	eles[0].style.display =into[0];
	eles[1].style.display =into[0];
	into[0] = k;
	k = eles[2].style.display;
	eles[2].style.display=into[1];
	into[1] = k;
	k = eles[3].style.backgroundColor;
	eles[3].style.backgroundColor=into[2];
	into[2] = k;
	k = eles[4].innerHTML;
	eles[4].innerHTML = into[3];
	into[3] = k;
//	刷新歌词
	try{
			for (var i = 0; i < a.time2.length; i++) {
			if(a.arrAwl[i].classList.length==2){a.arrAwl[i].classList.remove("audio-word-line-show");}
		}
	}catch(e){
		console.log("歌词未加载");
	}

}

//用户预加载
//(function(){
//	document.querySelector(".touxiang").style.backgroundImage = "url("+USER.IMAGE+")";
//	document.querySelector(".user").innerHTML = USER.NAME;
//})();
//document.getElementById("audioImg").onclick = audioShow;

//设置播放按钮
var myaudio = document.getElementById("myaudio");
//document.getElementById("playing").onclick = function(){
//	if(this.className == "audioPlay-4"){
//		myaudio.pause();
//		this.className = "audioPlay-2";
//	}else if(this.className == "audioPlay-2"){
//		myaudio.play();
//		this.className = "audioPlay-4";
//	}
//};


// 歌曲设置
function Audiodebug(data,domID,fun){
	this.lyrics =data.lyrics;
//	this.play_url = data.play_url;
	this.parrer=/\[[0-9]{2}\:[0-9]{2}\.[0-9]{2}\]/g;
	this.arr = data.lyrics.split(this.parrer);
	this.time2 = new Array();
	this.myaudio = AUDIO_ID.BFQ;
	this.range = AUDIO_ID.RANGE;
	this.audioWord = AUDIO_ID.WORD;
	this.audioWord.innerHTML = "";
	this.playing = AUDIO_ID.PLAYING;
	this.audioOnTime = AUDIO_ID.ONTIME;
	this.k = 0;
	this.arrAwl = document.getElementsByClassName("audio_word_line");
	this.audioWordCase = document.createElement("div");
	this.Ong = document.getElementById("audioOng");
	// 解析歌词
	this.getAudioWord = function(){ 
		var time = this.lyrics.match(this.parrer);
		this.audioWordCase.className = "audio_word_case";
		this.audioWord.appendChild(this.audioWordCase);
		for(var i=0;i<this.arr.length-1;i++){
			var node = document.createElement("div");
			node.className="audio_word_line";
			node.innerHTML = this.arr[i+1];
			this.audioWordCase.appendChild(node);
		}
		for (var i = 0; i < time.length; i++) {
			var t = time[i].slice(1, -1).split(':');  
		 	this.time2[i] = parseInt(t[0],10)*60 + parseFloat(t[1],10);
		 	t = null;
 		}
	};
//	 同步歌词''
	this.synAudioWord = function(){
		var thio = this;
		//播放开始
		this.myaudio.oncanplay = function(){
			thio.range.max = this.duration;
		}
		//播放进行中
		this.myaudio.ontimeupdate = function(){
			thio.range.value =this.currentTime;
			thio.audioOnTime.innerHTML =zhuanhua(Math.floor(this.currentTime));
			if(thio.Ong.style.display == "block"){
				var awh = thio.audioWord.offsetHeight;
				var awlh = thio.arrAwl[0].offsetHeight;
				for(var i = 0;i<thio.time2.length;i++){
					if(this.currentTime>thio.time2[i]&&this.currentTime<thio.time2[i+1]){
						if(i>0&&thio.arrAwl[i-1].classList.length==2){thio.arrAwl[i-1].classList.remove("audio_word_line_show");}
						thio.arrAwl[i].classList.add("audio_word_line_show");
						thio.audioWordCase.style.top = -((i+1)*(awlh+15)-awh/2)+"px";
						break;
					}
				}
			}
		};

		this.range.addEventListener("change",function(){
			try{
				thio.myaudio.currentTime = this.value;
				for (var i = 0; i < thio.time2.length; i++) {
				if(thio.arrAwl[i].classList.length==2){thio.arrAwl[i].classList.remove("audio-word-line-show");}
			}
			}catch(e){
			}
		})
	};
	// 设置播放按钮   ID
	this.inPlay = function(){  
		var thio = this;
		
	}
	// 一键挂载
	this.PLAY = function(){
		this.myaudio.src = this.play_url;
//		this.setBackgrounImg();
		this.getAudioWord();
		this.synAudioWord();
//		this.inPlay();
//		this.synAudioVolume();	
	};
}
//(function(){
//	a = new Audio(debugAudio.data);
//})()
//(function(){
//	a = new Audiodebug(debugAudio.data,AUDIO_ID);
//	a.PLAY();
//})()
function jieshaoShow(data){
	document.getElementById("audioBGImg").style.backgroundImage = "url("+data.img+")";
	document.getElementById("jieshao_1").innerHTML = data.song_name;
	document.getElementById("jieshao_2").innerHTML = data.author_name;
	document.getElementById("jieshao_3").innerHTML = data.album_name;
	document.getElementById("audioTime").innerHTML =zhuanhua( Math.floor(data.timelength/1000));
	document.getElementById("backimg").style.backgroundImage = "url("+data.img+")";
	document.getElementById("xiazai").href = data.play_url;
}

function audioPlay(n){
	if(n<0)return
	if(n+1>AUDIO_ARR.length){AUDIO_INDEX=0,n=0}
	var FileHash = window.parent.AUDIO_ARR[n].FileHash;
//  data = JSON.parse((new ajax("http://127.0.0.1/audio/audioPlay.php?FileHash="+FileHash)).data).data;
    data = JSON.parse((new ajax(HOST.HREF+"servlet/AUDIOIN?FileHash="+FileHash)).data).data;
//  加载基本信息
	jieshaoShow(data);	
	AUDIO_INDEX = n+1;
	a = new Audio(data,AUDIO_ID);
	a.PLAY();
}
//歌曲结束
//AUDIO_ID.BFQ.onended = function(){
//	audioPlay(AUDIO_INDEX);
//}
//添加歌词列表
function xiangmuAdd(){
	if(USER.NAME=="游客"){
		alert("对不起游客无法添加列表");
	}
}
